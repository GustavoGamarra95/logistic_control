spring:
  application:
    name: logistic-control-system

  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:logistic_db}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: update
    show-sql: ${SHOW_SQL:false}
    properties:
      hibernate:
        format_sql: true
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    validate-on-migrate: false

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

# Springdoc OpenAPI Configuration
springdoc:
  api-docs:
    path: /api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operationsSorter: method
    tagsSorter: alpha
    display-request-duration: true
    try-it-out-enabled: true
  show-actuator: true
  default-consumes-media-type: application/json
  default-produces-media-type: application/json

# Server Configuration
server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /api
  error:
    include-message: always
    include-binding-errors: always
    include-stacktrace: on_param
    include-exception: false

# JWT Configuration
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION:86400000} # 24 hours in milliseconds
  refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800000} # 7 days

# Encryption Configuration (AES-256)
encryption:
  secret-key: ${ENCRYPTION_KEY}

# SIFEN Configuration (Sistema Integrado de Facturación Electrónica Nacional - Paraguay)
sifen:
  ambiente: ${SIFEN_AMBIENTE:test} # test o prod
  url-test: https://sifen-test.set.gov.py/de/ws
  url-prod: https://sifen.set.gov.py/de/ws
  certificate-path: ${SIFEN_CERT_PATH:certificates/sifen-cert.p12}
  certificate-password: ${SIFEN_CERT_PASSWORD}
  certificate-type: P12
  connect-timeout: 10
  read-timeout: 60
  ruc-emisor: ${SIFEN_RUC:80000000-1}
  razon-social-emisor: ${SIFEN_RAZON_SOCIAL:EMPRESA LOGISTICA S.A.}
  nombre-fantasia: ${SIFEN_NOMBRE_FANTASIA:LOGISTICA EXPRESS}
  timbrado: ${SIFEN_TIMBRADO:12345678}
  establecimiento: ${SIFEN_ESTABLECIMIENTO:001}
  punto-expedicion: ${SIFEN_PUNTO_EXPEDICION:001}
  actividad-economica: ${SIFEN_ACTIVIDAD:Servicios de logística y transporte}
  direccion: ${SIFEN_DIRECCION:Asunción, Paraguay}
  telefono: ${SIFEN_TELEFONO:+595211234567}
  email: ${SIFEN_EMAIL:facturacion@logistica.com.py}
  ciudad: ${SIFEN_CIUDAD:Asunción}
  departamento: ${SIFEN_DEPARTAMENTO:11}
  contingencia-enabled: false
  max-reintentos: 3

# Grok API Configuration (xAI)
grok:
  api:
    enabled: ${GROK_ENABLED:false}
    url: ${GROK_API_URL:https://api.x.ai/v1/chat/completions}
    key: ${GROK_API_KEY:your-api-key-here}
    model: ${GROK_MODEL:grok-4}
    timeout: ${GROK_TIMEOUT:30000} # 30 seconds

# JasperReports Configuration
jasper:
  reports-path: classpath:templates/reports/
  images-path: classpath:static/images/

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when-authorized
  metrics:
    export:
      prometheus:
        enabled: true

# Logging Configuration
logging:
  level:
    root: INFO
    com.logistic.control: ${LOG_LEVEL:DEBUG}
    org.springframework.web: INFO
    org.springframework.security: INFO
    org.hibernate.SQL: ${HIBERNATE_SQL_LEVEL:DEBUG}
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss} - %msg%n'
    file: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'
  file:
    name: logs/logistic-control.log
    max-size: 10MB
    max-history: 30

# Application Custom Properties
app:
  version: 1.0.0
  timezone: America/Asuncion
  cors:
    allowed-origins: ${CORS_ORIGINS:http://localhost:3000,http://localhost:8080}
    allowed-methods: GET,POST,PUT,DELETE,OPTIONS
    allowed-headers: '*'
    allow-credentials: true

  # Business rules
  business:
    iva-rate: 0.10 # 10% IVA Paraguay
    default-currency: PYG
    stock-alert-threshold: 10

  # File upload
  upload:
    max-file-size: 5MB
    allowed-types: pdf,jpg,jpeg,png,doc,docx,xls,xlsx
